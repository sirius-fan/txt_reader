# PySide6 小说阅读器

一个功能完整的文本小说阅读器，使用 PySide6 开发。

## 功能特性

### 📚 基本功能
- **打开文本文件**: 
  - 智能编码检测，支持 UTF-8、GBK、GB2312、Big5 等多种编码
  - 手动编码选择，确保文件正确打开
  - 容错机制，避免因编码问题导致的打开失败
- **自动章节解析**: 智能识别章节标题，支持多种章节标题格式
- **智能章节导航**: 
  - 左侧章节列表，可点击跳转到任意章节
  - 自动章节跳转：在章节末尾滚轮或按键自动跳转到下一章
  - 快捷键导航：Ctrl+方向键快速切换章节
  - 工具栏按钮：上一章/下一章按钮

### 🎨 界面自定义
- **完整字体设置**: 
  - 通过菜单栏或工具栏访问字体对话框
  - 支持字体类型、大小、粗体、斜体等完整设置
  - 实时预览字体效果
- **字体大小调节**: 
  - 工具栏滑块实时调节字体大小（8-72号）
  - 快捷按钮（+/-）快速调整字体大小
  - 菜单栏预设字体大小快速选择
- **颜色自定义**: 
  - 自定义阅读区域背景颜色
  - 自定义文字颜色
  - 实时颜色预览和反馈
- **预设主题**: 
  - 默认主题（白底黑字）
  - 护眼深色主题（深灰底浅色字）
  - 护眼米黄主题（米黄底深棕字）
- **界面布局**: 
  - 侧边栏显示/隐藏切换（F9键）
  - 灵活的阅读区域大小调整
  - 专注阅读模式支持
- **设置持久化**: 自动保存和恢复用户所有自定义设置

### 🔍 搜索功能
- **全文搜索**: 在当前章节中搜索关键词
- **大小写敏感**: 可选择是否区分大小写
- **搜索导航**: 上一个/下一个搜索结果跳转
- **搜索高亮**: 自动高亮显示搜索结果

### 📊 阅读辅助
- **页码显示**: 状态栏显示当前页码和总页数
- **位置信息**: 显示当前光标在文本中的位置
- **章节下拉框**: 工具栏快速章节选择

## 安装与使用

### 系统要求
- Python 3.8+
- Linux/Windows/macOS

### 安装依赖
程序已经预配置了虚拟环境，依赖包包括：
- PySide6: Qt6 Python绑定
- chardet: 字符编码检测

### 运行程序

#### 方法一：使用启动脚本
```bash
./run.sh
```

#### 方法二：直接运行Python
```bash
./.venv/bin/python main.py
```

## 使用说明

### 打开文件
#### 自动编码检测（推荐）
1. 点击菜单栏 "文件" -> "打开" 或使用快捷键 `Ctrl+O`
2. 选择要阅读的 txt 文件
3. 程序会自动检测文件编码并显示内容
4. 状态栏显示检测到的编码信息

#### 手动编码选择
1. 点击菜单栏 "文件" -> "重新编码打开"
2. 选择具体编码（UTF-8、GBK、GB2312、Big5 等）
3. 选择文件，程序使用指定编码打开
4. 适用于自动检测失败或显示乱码的情况

### 章节导航
#### 自动跳转（推荐）
1. **阅读到章节末尾时**：
   - 鼠标滚轮向下滚动 → 自动跳转到下一章开头
   - 按 `PageDown` 或 `↓` 键 → 自动跳转到下一章开头

2. **在章节开头时**：
   - 鼠标滚轮向上滚动 → 自动跳转到上一章末尾
   - 按 `PageUp` 或 `↑` 键 → 自动跳转到上一章末尾

#### 手动跳转
- **左侧章节列表**: 点击任意章节直接跳转
- **工具栏按钮**: 点击 "上一章" 或 "下一章" 按钮
- **章节下拉框**: 快速选择章节
- **快捷键导航**:
  - `Ctrl+←`: 上一章
  - `Ctrl+→`: 下一章
  - `Ctrl+Home`: 第一章
  - `Ctrl+End`: 最后一章
- **界面控制**:
  - `F9`: 切换侧边栏显示/隐藏
  - `Ctrl+Shift+F`: 字体设置
  - `Ctrl+F`: 搜索
  - `Ctrl+O`: 打开文件

### 字体和颜色设置
- **完整字体设置**: 
  - 菜单栏 "视图" -> "字体设置" (Ctrl+Shift+F)
  - 工具栏 "字体" 按钮
  - 支持字体类型、大小、粗体、斜体等完整自定义
- **字体大小快速调节**: 
  - 工具栏滑块拖拽调节
  - 工具栏 +/- 按钮快速调节
  - 菜单栏预设大小快速选择 (8-72号)
- **颜色设置**: 
  - 菜单栏选择背景颜色和字体颜色
  - 实时预览和状态栏反馈
- **预设主题**: 
  - 菜单栏 "视图" -> "预设主题"
  - 默认主题、护眼深色、护眼米黄三种主题

### 界面布局
- **侧边栏控制**:
  - 快捷键 `F9` 切换章节目录显示/隐藏
  - 工具栏按钮 "隐藏目录"/"显示目录"
  - 菜单栏 "视图" -> "显示侧边栏"
- **专注阅读**: 隐藏侧边栏获得更大阅读区域
- **章节导航**: 显示侧边栏方便章节跳转

### 搜索功能
1. 按 `Ctrl+F` 或菜单栏 "搜索" -> "查找" 打开搜索面板
2. 输入关键词
3. 可选择是否区分大小写
4. 点击 "搜索" 或按回车开始搜索
5. 使用 "上一个"/"下一个" 导航搜索结果

### 支持的章节标题格式
程序能自动识别以下格式的章节标题：
- `第一章 章节标题`
- `第1章 章节标题`
- `Chapter 1 标题`
- `章节1 标题`
- `1. 标题`
- `第一节 标题`

## 技术特性

### 架构设计
- **MVC模式**: 清晰的模型-视图-控制器分离
- **模块化**: 章节解析器、搜索线程等独立模块
- **异步搜索**: 搜索功能在独立线程中执行，避免界面卡顿

### 性能优化
- **智能编码检测**: 双重检测机制，支持 GBK/GB2312/Big5/UTF-8 等编码
- **中文优化**: 优先识别和处理中文编码文件
- **内存管理**: 按章节加载内容，减少内存占用
- **搜索优化**: 正则表达式优化的搜索算法
- **容错处理**: 编码错误时自动使用替换策略，确保文件能正常打开

### 用户体验
- **设置持久化**: 自动保存用户偏好设置
- **快捷键支持**: 常用功能快捷键支持
- **状态反馈**: 实时显示页码、位置等信息

## 开发信息

- **开发语言**: Python 3.13
- **GUI框架**: PySide6 (Qt6)
- **编码检测**: chardet
- **配置管理**: QSettings

## 许可证

本项目仅供学习和个人使用。
